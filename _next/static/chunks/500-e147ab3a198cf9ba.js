(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[500],{5825:function(e,t,s){"use strict";s.r(t);var a=s(5893),i=s(7294),r=s(1502),n=s.n(r),o=s(2639),l=s.n(o),c=s(1830),h=s(5507),d=s(2730),p=s(5888);class m extends i.Component{getListKey(){return this.listIndex++,"Expaination-List-"+this.listIndex}render(){var e=[],t=(0,a.jsx)("div",{});if(this.listIndex=0,!this.props.block||!this.props.trie)return t;if(this.props.clickedPathData){var{_:s,_:s,stack:i}=this.props.clickedPathData,r=i.length,o=this.props.clickedTid,m=(0,p.L)(h.RLP.encode(o)),u=0;g=(0,a.jsxs)("li",{children:["Our lookup path is for Transaction Id:",o,". RLP(Transaction Id):",(0,d.bufferToHex)((0,p.E)(m)),"."]},this.getListKey()),e.push(g);for(var f=0;f<r;f++){var g,v,k=i[f],x=[];(k instanceof c.LeafNode||k instanceof c.ExtensionNode)&&(x=k.key());var y=this.props.clickedNames[r-f-1].name;if(g=y.includes("Root")?(0,a.jsxs)("li",{children:["We perform lookup in the database using block.transactionsRoot:",this.props.block.transactionsRoot," to get the root node ",y,"."]},this.getListKey()):(0,a.jsxs)("li",{children:["We perform lookup in the database using key to get the node ",y,"."]},this.getListKey()),e.push(g),y.includes("BN")){v=m[u++];var _=k._branches[v];g=u==m.length?(0,a.jsxs)("li",{children:["Our lookup path terminates at branch node ",y,". We use value field from this node to get the transaction details."]},this.getListKey()):(0,a.jsxs)("li",{children:["We use nibble: 0x",v.toString(16)," from RLP(Transaction Id) as index in the branches of this node to get key:",(0,d.bufferToHex)(_)," for the next node"]},this.getListKey()),e.push(g)}if(y.includes("EN")){for(var b="",C=0;C<x.length;C++)b+=(v=m[u]).toString(16),u++;var _=k._value;g=(0,a.jsxs)("li",{children:["The node ",y," is an extension node. The nibbles matched from lookup path are 0x",b,". The value field of this node is used to get key:",(0,d.bufferToHex)(_)," for the next node"]},this.getListKey()),e.push(g)}if(y.includes("LN")){for(var b="",C=0;C<x.length;C++)u<m.length&&(b+=(v=m[u]).toString(16),u++);var N="";x.length>0&&(N="Nibbles matching the lookup path are 0x"+b),g=(0,a.jsxs)("li",{children:["The node ",y," is the leaf node which contains the transaction we are looking for. ",N]},this.getListKey()),e.push(g)}}var w=this.props.clickedPathData&&0!=this.props.clickedPathData.length?(0,a.jsx)("div",{className:l().explain,children:(0,a.jsx)("ul",{children:e})}):(0,a.jsx)("p",{children:"Please select click nodes in the above tree till you reach a leaf node to see explaination for specific path"});t=(0,a.jsxs)("div",{className:n().card,children:[(0,a.jsx)("h2",{children:"Explaination"}),(0,a.jsx)("p",{children:"The tree consists of database with (key,value) pairs where key is the hash of the node and value represents the node structure stored in RLP format. We can find a trasaction in this tree by following a path using the nibbles in RLP(transaction id)."}),w,(0,a.jsx)("h2",{children:"Reference"}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"https://ethereum.org/en/developers/docs/data-structures-and-encoding/",children:"Ethereum Data Structures and Encoding"})})]})}return t}}t.default=m},5173:function(e,t,s){"use strict";s.r(t);var a=s(5893),i=s(7294),r=s(2639),n=s.n(r),o=s(5507),l=s(2984);let c={vertical:{title:{textAnchor:"start",x:26,y:5},attributes:{},attribute:{x:40,dy:"1.2em"}},horizontal:{title:{textAnchor:"start",y:40},attributes:{x:0,y:40},attribute:{x:0,dy:"1.2em"}}},h=e=>{let{nodeDatum:t,orientation:s,toggleNode:i}=e;var r="Empty"===t.name?(0,a.jsx)("div",{}):(0,a.jsx)("circle",{id:t.name,r:18,onClick:i});return(0,a.jsxs)(a.Fragment,{children:[r,(0,a.jsxs)("g",{className:n().card,onClick:()=>{},children:[(0,a.jsx)("text",{className:n().node__text,...c[s].title,onClick:()=>{},children:t.name}),(0,a.jsx)("text",{className:"rd3t-label__attributes",...c[s].attributes,children:t.attributes&&Object.entries(t.attributes).map((e,t)=>{let[i,r]=e;return(0,a.jsxs)("tspan",{...c[s].attribute,children:[i,": ",r]},"".concat(i,"-").concat(t))})})]})]})};class d extends i.Component{setContainer(e){this.treeContainer=e}componentDidMount(){if(!this.mounted){if(this.mounted=!0,this.treeContainer){let e=this.treeContainer.getBoundingClientRect();this.setState({translate:{x:e.width/2,y:e.height/10}})}for(var t=this.props.trieJson,s=[];t;){s.push(t.name);var a=t.children,i=a?Math.floor(a.length/2):0;if(a&&"Empty"===a[i].name){for(;"Empty"===a[i].name&&!(--i<0););if(i<0){for(i=a?Math.floor(a.length/2):0;"Empty"===a[i].name;)if(++i>=a.length){i=0;break}}}t=a&&a[i]?a[i]:null}this.nodesToClick=s,this.simulateNodeClick()}}sleepFor(e){return new Promise(t=>{setTimeout(t,e)})}async simulateNodeClick(){var e=this.nodesToClick;if(!e||0==e.length){await this.sleepFor(500);var t=document.getElementById("treeContainer");t&&t.scrollIntoView({behavior:"smooth",block:"start"});return}for(var s=e[0],a=[],i=1;i<e.length;i++)a.push(e[i]);this.nodesToClick=a;var r=document.getElementById(s);if(r){console.log("Simulating click for id:"+s);let n=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});r.dispatchEvent(n)}else console.log("id:"+s+" not found")}getDynamicPathClass(e,t){if(this.state.clickedX){for(var s=0;s<this.state.clickedX.length;s++)if(this.state.clickedX[s]==e.target.x&&this.state.clickedY[s]==e.target.y)return"node__linkselected"}return"node__link"}async processNodeClick(e){for(var t=[],s=[],a=e.hierarchyPointNode;a;)t.push(a.x),s.push(a.y),a=a.parent;this.setState({clickedX:t,clickedY:s});var i=e.hierarchyPointNode.data;if(i.name){console.log("onNodeClick clicked Node:",i.name);var r=i.name.replace("Root-","").split("-");if(2==r.length&&("LN"==r[0]||"EN"==r[0])){var n=parseInt(r[1]),l=o.RLP.encode(n);if(console.log("clickedTid:"+n),this.props.trie){var c=e.hierarchyPointNode;await this.processTransactionClick(l,c,n)}}else if(3==r.length&&"BN"==r[0]){var n=parseInt(r[2]),l=o.RLP.encode(n);if(console.log("clickedTid:"+n),this.props.trie){var c=e.hierarchyPointNode;await this.processTransactionClick(l,c,n)}}else this.props.setClickedPath(null,[],0)}else console.log("onNodeClick clicked Node: has no name"),this.props.setClickedPath(null,[],0);await this.simulateNodeClick()}async processTransactionClick(e,t,s){try{var{trieNode:a,remaining:i,stack:r}=await this.props.trie.findPath(e),n=[{name:t.data.name,childnames:[]}];for(t=t.parent;t;){var o=t.children;o||(o=[]);for(var l=[],c=0;c<o.length;c++)l.push(o[c].data.name);n.push({name:t.data.name,childnames:l}),t=t.parent}this.props.setProgress(!0),this.props.setMessage("Calculating path"),await this.sleepFor(1e3),this.props.setMessage("Click on the tree nodes to show a different path. Path details will be shown when you click on the leaf node. Scroll below to see details of each node in the path."),this.props.setProgress(!1),this.props.setClickedPath({trieNode:a,remaining:i,stack:r},n,s)}catch(h){console.log("error:"+h)}}render(){var e=(0,a.jsx)("div",{});return this.props.trieJson&&(e=(0,a.jsx)(l.Z,{data:this.props.trieJson,orientation:"vertical",shouldCollapseNeighborNodes:"true",initialDepth:"0",centeringTransitionDuration:"800",translate:this.state.translate,rootNodeClassName:n().node__root,branchNodeClassName:n().node__branch,leafNodeClassName:n().node__leaf,pathClassFunc:this.getDynamicPathClass,renderCustomNodeElement:e=>{var t,s;return t={...e},s=this.processNodeClick,(0,a.jsx)(h,{nodeDatum:t.nodeDatum,orientation:"vertical",toggleNode:async()=>{await t.toggleNode(),await s(t)}})}})),(0,a.jsx)("div",{className:n().trietreeview,id:"treeWrapper",style:{width:"100%",height:"22em"},ref:e=>this.setContainer(e),children:e})}constructor(e){super(e),this.getDynamicPathClass=this.getDynamicPathClass.bind(this),this.processNodeClick=this.processNodeClick.bind(this),this.processTransactionClick=this.processTransactionClick.bind(this),this.simulateNodeClick=this.simulateNodeClick.bind(this),this.setContainer=this.setContainer.bind(this),this.state={}}}t.default=d},6500:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(5893),i=s(7294),r=s(2639),n=s.n(r),o=s(5173),l=s(8122),c={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0},h=function(e,t,s){var a="react-spinners-".concat(e,"-").concat(s);if("undefined"==typeof window||!window.document)return a;var i=document.createElement("style");document.head.appendChild(i);var r=i.sheet,n="\n    @keyframes ".concat(a," {\n      ").concat(t,"\n    }\n  ");return r&&r.insertRule(n,0),a},d=function(){return(d=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var i in t=arguments[s])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,a=Object.getOwnPropertySymbols(e);i<a.length;i++)0>t.indexOf(a[i])&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(s[a[i]]=e[a[i]]);return s},m=[h("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(-").concat(5,"rem) scale(0.5)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-0"),h("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-1"),h("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    75% {transform: translateX(-").concat(1,"rem) scale(0.75)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-2"),h("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    75% {transform: translateX(").concat(1,"rem) scale(0.75)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-3"),h("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-4"),h("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(").concat(5,"rem) scale(0.5)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-5")],u=function(e){var t=e.loading,s=e.color,a=void 0===s?"#000000":s,r=e.speedMultiplier,n=void 0===r?1:r,o=e.cssOverride,l=e.size,h=p(e,["loading","color","speedMultiplier","cssOverride","size"]),u=function(e){if("number"==typeof e)return{value:e,unit:"px"};var t,s=(e.match(/^[0-9.]*/)||"").toString();t=s.includes(".")?parseFloat(s):parseInt(s,10);var a=(e.match(/[^0-9]*$/)||"").toString();return c[a]?{value:t,unit:a}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}(void 0===l?15:l),f=u.value,g=u.unit,v=d({display:"inherit",position:"relative"},void 0===o?{}:o),k=function(e){return{position:"absolute",fontSize:"".concat(f/3).concat(g),width:"".concat(f).concat(g),height:"".concat(f).concat(g),background:a,borderRadius:"50%",animation:"".concat(m[e]," ").concat(1.5/n,"s infinite"),animationFillMode:"forwards"}};return void 0===t||t?i.createElement("span",d({style:v},h),i.createElement("span",{style:k(0)}),i.createElement("span",{style:k(1)}),i.createElement("span",{style:k(2)}),i.createElement("span",{style:k(3)}),i.createElement("span",{style:k(4)}),i.createElement("span",{style:k(5)})):null},f=s(5825),g=s(5888),v=s(5507),k=s(1830);class x extends i.Component{componentDidMount(){if(!this.mounted&&(this.mounted=!0,console.log("TrieViewContainer mounted"),this.treeContainer)){let e=this.treeContainer.getBoundingClientRect();this.setState({translate:{x:e.width/2,y:e.height/10}})}}setClickedPath(e,t,s){this.setState({clickedPathData:e,clickedNames:t,clickedTid:s})}setMessage(e){this.props.setMessage(e)}setProgress(e){this.props.setProgress(e)}getListKey(){return this.listIndex++,"Node-kEY-"+this.listIndex}render(){var e=(0,a.jsx)("div",{});this.listIndex=0,!this.props.error&&this.props.block&&this.props.trie&&this.props.trieJson&&(e=(0,a.jsx)(o.default,{trieJson:this.props.trieJson,trie:this.props.trie,block:this.props.block,setClickedPath:this.setClickedPath,setMessage:this.setMessage,setProgress:this.setProgress}));var t=(0,a.jsx)("div",{});if(this.state.clickedPathData)for(var{_:s,_:s,stack:i}=this.state.clickedPathData,r=(0,g.L)(v.RLP.encode(this.state.clickedTid)),c=0,h=[],d=i.length,p=0;p<d;p++){var m=i[p],x=1;(m instanceof k.LeafNode||m instanceof k.ExtensionNode)&&(x=m.key().length),h.push((0,a.jsx)(l.default,{names:this.state.clickedNames[d-p-1],node:m,trie:this.props.trie,block:this.props.block,branchid:r[c]},this.getListKey())),c+=x}t=(0,a.jsxs)("div",{className:n().transactiongrid,id:"nodeViewDiv",children:[(0,a.jsx)(f.default,{trie:this.props.trie,clickedPathData:this.state.clickedPathData,clickedNames:this.state.clickedNames,clickedTid:this.state.clickedTid,block:this.props.block}),h]});var y=this.props.showProgress?(0,a.jsx)("div",{className:n().cliploaderparent,children:(0,a.jsx)("div",{className:n().cliploader,children:(0,a.jsx)(u,{loading:this.props.showProgress,size:20,"aria-label":"Loading Spinner","data-testid":"loader"})})}):(0,a.jsx)("div",{});this.props.showProgress&&(t=(0,a.jsx)("div",{id:"nodeViewDiv"}));var _=this.props.trie?(0,a.jsxs)("div",{className:n().trietreeview,style:{width:"100%",height:"22em"},ref:e=>this.treeContainer=e,children:[e,y]}):(0,a.jsx)("div",{className:n().trietreeview,style:{width:"100%",height:"22em"},ref:e=>this.treeContainer=e,children:y});return(0,a.jsxs)("div",{id:"treeContainer",className:n().trieview,children:[(0,a.jsx)("div",{className:n().tip,children:(0,a.jsx)("p",{children:this.props.message})}),_,t]})}constructor(e){super(e),this.setClickedPath=this.setClickedPath.bind(this),this.setProgress=this.setProgress.bind(this),this.setMessage=this.setMessage.bind(this),this.state={}}}var y=x},2639:function(e){e.exports={formMargin:"styles_formMargin__reMk_",formButton:"styles_formButton__tKhZn",topMargin:"styles_topMargin__6Cv_9",cardHeader:"styles_cardHeader__IX_ep",transactiongrid:"styles_transactiongrid__sDXnE",node__root:"styles_node__root__VIk5x",node__branch:"styles_node__branch__qmy62",node__leaf:"styles_node__leaf__R9C_K",node__text:"styles_node__text__ik9m4",trieview:"styles_trieview__EhA_i",trietreeview:"styles_trietreeview__6a47O",cliploader:"styles_cliploader__MvDxQ",cliploaderparent:"styles_cliploaderparent__Hdl9S",tip:"styles_tip__UwbPR",explain:"styles_explain__EsNwv",center:"styles_center__Z_nYJ",content:"styles_content__jgOxM"}}}]);