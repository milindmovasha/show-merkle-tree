(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[120],{5012:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/trieview",function(){return s(5173)}])},5173:function(e,t,s){"use strict";s.r(t);var i=s(5893),n=s(7294),a=s(2639),r=s.n(a),o=s(5507),l=s(2984);let c={vertical:{title:{textAnchor:"start",x:26,y:5},attributes:{},attribute:{x:40,dy:"1.2em"}},horizontal:{title:{textAnchor:"start",y:40},attributes:{x:0,y:40},attribute:{x:0,dy:"1.2em"}}},h=e=>{let{nodeDatum:t,orientation:s,toggleNode:n}=e;var a="Empty"===t.name?(0,i.jsx)("div",{}):(0,i.jsx)("circle",{id:t.name,r:18,onClick:n});return(0,i.jsxs)(i.Fragment,{children:[a,(0,i.jsxs)("g",{className:r().card,onClick:()=>{},children:[(0,i.jsx)("text",{className:r().node__text,...c[s].title,onClick:()=>{},children:t.name}),(0,i.jsx)("text",{className:"rd3t-label__attributes",...c[s].attributes,children:t.attributes&&Object.entries(t.attributes).map((e,t)=>{let[n,a]=e;return(0,i.jsxs)("tspan",{...c[s].attribute,children:[n,": ",a]},"".concat(n,"-").concat(t))})})]})]})};class d extends n.Component{setContainer(e){this.treeContainer=e}componentDidMount(){if(!this.mounted){if(this.mounted=!0,this.treeContainer){let e=this.treeContainer.getBoundingClientRect();this.setState({translate:{x:e.width/2,y:e.height/10}})}for(var t=this.props.trieJson,s=[];t;){s.push(t.name);var i=t.children,n=i?Math.floor(i.length/2):0;if(i&&"Empty"===i[n].name){for(;"Empty"===i[n].name&&!(--n<0););if(n<0){for(n=i?Math.floor(i.length/2):0;"Empty"===i[n].name;)if(++n>=i.length){n=0;break}}}t=i&&i[n]?i[n]:null}this.nodesToClick=s,this.simulateNodeClick()}}sleepFor(e){return new Promise(t=>{setTimeout(t,e)})}async simulateNodeClick(){var e=this.nodesToClick;if(!e||0==e.length){await this.sleepFor(500);var t=document.getElementById("treeContainer");t&&t.scrollIntoView({behavior:"smooth",block:"start"});return}for(var s=e[0],i=[],n=1;n<e.length;n++)i.push(e[n]);this.nodesToClick=i;var a=document.getElementById(s);if(a){console.log("Simulating click for id:"+s);let r=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});a.dispatchEvent(r)}else console.log("id:"+s+" not found")}getDynamicPathClass(e,t){if(this.state.clickedX){for(var s=0;s<this.state.clickedX.length;s++)if(this.state.clickedX[s]==e.target.x&&this.state.clickedY[s]==e.target.y)return"node__linkselected"}return"node__link"}async processNodeClick(e){for(var t=[],s=[],i=e.hierarchyPointNode;i;)t.push(i.x),s.push(i.y),i=i.parent;this.setState({clickedX:t,clickedY:s});var n=e.hierarchyPointNode.data;if(n.name){console.log("onNodeClick clicked Node:",n.name);var a=n.name.replace("Root-","").split("-");if(2==a.length&&("LN"==a[0]||"EN"==a[0])){var r=parseInt(a[1]),l=o.RLP.encode(r);if(console.log("clickedTid:"+r),this.props.trie){var c=e.hierarchyPointNode;await this.processTransactionClick(l,c,r)}}else if(3==a.length&&"BN"==a[0]){var r=parseInt(a[2]),l=o.RLP.encode(r);if(console.log("clickedTid:"+r),this.props.trie){var c=e.hierarchyPointNode;await this.processTransactionClick(l,c,r)}}else this.props.setClickedPath(null,[],0)}else console.log("onNodeClick clicked Node: has no name"),this.props.setClickedPath(null,[],0);await this.simulateNodeClick()}async processTransactionClick(e,t,s){try{var{trieNode:i,remaining:n,stack:a}=await this.props.trie.findPath(e),r=[{name:t.data.name,childnames:[]}];for(t=t.parent;t;){var o=t.children;o||(o=[]);for(var l=[],c=0;c<o.length;c++)l.push(o[c].data.name);r.push({name:t.data.name,childnames:l}),t=t.parent}this.props.setProgress(!0),this.props.setMessage("Calculating path"),await this.sleepFor(1e3),this.props.setMessage("Click on the tree nodes to show a different path. Path details will be shown when you click on the leaf node. Scroll below to see details of each node in the path."),this.props.setProgress(!1),this.props.setClickedPath({trieNode:i,remaining:n,stack:a},r,s)}catch(h){console.log("error:"+h)}}render(){var e=(0,i.jsx)("div",{});return this.props.trieJson&&(e=(0,i.jsx)(l.Z,{data:this.props.trieJson,orientation:"vertical",shouldCollapseNeighborNodes:"true",initialDepth:"0",centeringTransitionDuration:"800",translate:this.state.translate,rootNodeClassName:r().node__root,branchNodeClassName:r().node__branch,leafNodeClassName:r().node__leaf,pathClassFunc:this.getDynamicPathClass,renderCustomNodeElement:e=>{var t,s;return t={...e},s=this.processNodeClick,(0,i.jsx)(h,{nodeDatum:t.nodeDatum,orientation:"vertical",toggleNode:async()=>{await t.toggleNode(),await s(t)}})}})),(0,i.jsx)("div",{className:r().trietreeview,id:"treeWrapper",style:{width:"100%",height:"22em"},ref:e=>this.setContainer(e),children:e})}constructor(e){super(e),this.getDynamicPathClass=this.getDynamicPathClass.bind(this),this.processNodeClick=this.processNodeClick.bind(this),this.processTransactionClick=this.processTransactionClick.bind(this),this.simulateNodeClick=this.simulateNodeClick.bind(this),this.setContainer=this.setContainer.bind(this),this.state={}}}t.default=d},2639:function(e){e.exports={formMargin:"styles_formMargin__reMk_",formButton:"styles_formButton__tKhZn",topMargin:"styles_topMargin__6Cv_9",cardHeader:"styles_cardHeader__IX_ep",transactiongrid:"styles_transactiongrid__sDXnE",node__root:"styles_node__root__VIk5x",node__branch:"styles_node__branch__qmy62",node__leaf:"styles_node__leaf__R9C_K",node__text:"styles_node__text__ik9m4",trieview:"styles_trieview__EhA_i",trietreeview:"styles_trietreeview__6a47O",cliploader:"styles_cliploader__MvDxQ",cliploaderparent:"styles_cliploaderparent__Hdl9S",tip:"styles_tip__UwbPR",explain:"styles_explain__EsNwv",center:"styles_center__Z_nYJ",content:"styles_content__jgOxM"}}},function(e){e.O(0,[522,984,774,888,179],function(){return e(e.s=5012)}),_N_E=e.O()}]);